<!DOCTYPE >
<html>
	<title>竞赛申报系统</title>
	<head>
		<script src="./layui/layui.js"></script>
		<link href="./layui/css/layui.css"  rel="stylesheet"/>
		
		<script src="./host.js"></script>
		<script src="https://cdn.staticfile.org/jquery/1.10.2/jquery.min.js"></script>
		
		<style>
			#buttonBox{
				float:left;
				width:15%;
				height:80%;
				margin:10px;
				border:solid 1px #ccc;
				background:#00a997;
				border-radius:5px;
				margin-right: 0;
			}
			.menu{
				height: 20%;
				color:#2c3e50;
				overflow: hidden;
				padding: 0 10px;
				z-index:1;
			}
			.menu:hover{
				background:#5fb878;
				cursor:pointer;
				color:#ffffff;
			}
      #mainContent{
        height: 85%;
        width: 81%;
        margin: 10px 20px 20px 0;
        border:solid 1px #ccc;
        background:white;
        border-radius:5px;
        float: right;
      }
			.icon{
				border-radius: 200px; 
				margin:auto;
			}
			.buttonIcon{
				height: 60%;
				margin-top:5px;
				text-align: center;
			}
			.buttonText{
				text-align: center;
			}
			#userName:hover{
				cursor:pointer
			}
		</style>
	</head>

	<body style="background-color: #eeeeee;">
		<ul class="layui-nav layui-bg-green">
			<li class="layui-nav-item layui-this"><a href="">主页</a></li>
      <li class="layui-nav-item layui-this layui-layout-right id=acc-info" style="margin-right:20px;">
        <a id="userName">解决方案</a>
        <dl class="layui-nav-child"> <!-- 二级菜单 -->
          <dd><a href="" >个人信息</a></dd>
          <dd><a href="index.html" >登出</a></dd>
        </dl>
      </li>
		</ul>

		<div id="buttonBox">
        <div id="headPhotoBox" class="icon" style="width: 70%; margin-top:10px;margin-bottom: 10px;border: 1px solid #eeeeee; ">
          <img  id="headPhoto" style="width: 100%;"/>
        </div>
        <div id="headName" style="font-size: 30px;width: 100%;text-align: center;margin: 10px 0;">
          name
        </div>
        <div style="height: 0.5px;width:80%;background: #eeeeee;text-align: center;margin:0 auto;"></div>

    		<div class="menu" id="contestInfo">
					<div  class="icon buttonIcon">
		    	<i class="layui-icon layui-icon-rate"></i>
					</div>
					<div class="buttonText">竞赛详情</div>
		    </div>
				<div style="height: 2px;width:80%;background: #eeeeee;text-align: center;margin:0 auto;"></div>
		    <div class="menu" id="projectList">
		    	 <div  class="icon buttonIcon">
		    	 <i class="layui-icon layui-icon-read"></i>
		    	 </div>
		    	 <div class="buttonText">作品列表</div>
		    </div>
				<div style="height: 2px;width:80%;background: #eeeeee;text-align: center;margin:0 auto;"></div>
        
    </div>

    <div id="mainContent" > 
      <div style="height: 500px;width: 100%;">

        <form class="layui-form" lay-filter="contestInfo">
        <div class="layui-row">
        <div class="layui-col-md5">
            <div style="height:3%"></div>

            <div class="layui-form-item">
            <label class="layui-form-label">赛事名称</label>
            <div class="layui-input-inline style="width: 60%;"> 
                <input type="text" class="layui-input" name="competitionName" required  lay-verify="required" autocomplete="off">
            </div>
            </div>

            <div class="layui-form-item">
                <label class="layui-form-label">赛事简称</label>
                <div class="layui-input-inline style="width: 60%;"> 
                    <input type="text" class="layui-input" name="acronym" required  lay-verify="required" autocomplete="off">
                </div>
            </div>


            <div class="layui-form-item">
            <label class="layui-form-label">开始时间</label>
            <div class="layui-input-inline style="width: 60%;"> 
                <input type="text" class="layui-input" id="startDate" name="startDate" required  lay-verify="required|date" autocomplete="off">
            </div>
            </div>

            <div class="layui-form-item">
                <label class="layui-form-label">提交截至</label>
                <div class="layui-input-inline style="width: 60%;"> 
                    <input type="text" class="layui-input time" id="submitDDL" name="submitDDL" required  lay-verify="required|date" autocomplete="off">
                </div>
            </div>
            
            <div class="layui-form-item">
              <label class="layui-form-label">初审截至</label>
              <div class="layui-input-inline style="width: 60%;"> 
                  <input type="text" class="layui-input time" id="checkDDL" name="checkDDL" required  lay-verify="required|date" autocomplete="off">
              </div>
            </div>

            <div class="layui-form-item">
              <label class="layui-form-label">评审截至</label>
              <div class="layui-input-inline style="width: 60%;"> 
                  <input type="text" class="layui-input time" id="reviewDDL" name="reviewDDL" required  lay-verify="required|date" autocomplete="off">
              </div>
            </div>

            <div class="layui-form-item">
              <label class="layui-form-label">结果公布</label>
              <div class="layui-input-inline style="width: 60%;"> 
                  <input type="text" class="layui-input time" id="endDate" name="endDate" required  lay-verify="required|date" autocomplete="off">
              </div>
            </div>
            
            <div class="layui-form-item layui-form-text">
                <label class="layui-form-label">赛事描述</label>
                <div class="layui-input-inline style="width: 60%;"> 
                    <textarea class="layui-input" name="description" autocomplete="off" style="width:300px;height:100px"></textarea>
                </div>
            </div>
        </div>
        </div>
        <div class="layui-row">
				<div class="layui-col-md2 layui-col-md-offset1">
                    <button class="layui-btn layui-btn-radius layui-btn-normal" lay-submit lay-filter="newContest" style="width:100%">保存</button>
				</div>
		</div>
        </form>
		<div class="layui-row" style="margin: 20px 0;">
				<div class="layui-col-md2 layui-col-md-offset1">
		            <button class="layui-btn layui-btn-radius layui-btn-normal" id="return" style="width:100%">返回</button>
				</div>
		</div>
      </div>
    </div>
    <script>
      layui.use('laydate',function(){
            var laydate=layui.laydate;
            lay('.time').each(function(){
              laydate.render({
                elem:this
                ,format:'yyyy/M/d'
              });
            });
      });
    </script>
	</body>
	<script>
		layui.use('element', function(){
			var element = layui.element;

		});
		$("#headPhotoBox").height($("#headPhotoBox").width());
		$('#headPhoto').attr("src", "./img/竞赛.png");
		$(".buttonIcon").width($(".buttonIcon").height());
		$(".layui-icon").css("font-size",$(".buttonIcon").height()*0.7);
		$(".buttonText").css("font-size",$(".buttonIcon").height()*0.2);
		var contest=JSON.parse(sessionStorage.getItem("contest"));
		if(contest.competitionName)
			$("#headName").html(contest.competitionName);
		else
			$("#headName").html("no name");
		var user=JSON.parse(sessionStorage.getItem("user"));
		$("#userName").html(user.account);
        $("#newContest").click(function(){
            window.location.href="newContest.html";
        });
        $("#contestList").click(function(){
            window.location.href="school.html";
        });
        layui.use(['form','laydate'], function(){
            var form = layui.form;
            var laydate=layui.laydate;
            laydate.render({
                elem: '#startDate'
            });
            laydate.render({
                elem: '#submitDDL'
            });
            laydate.render({
                elem: '#checkDDL'
            });
            laydate.render({
                elem: '#reviewDDL'
            });
            laydate.render({
                elem: '#endDate'
            });
            //监听提交
            form.on('submit(newContest)', function(data){
				//console.log(JSON.stringify(data));
				$.ajax({
					type:"POST",
					url: hostIP+"competition",
					dataType:"json",
					contentType:"application/json", // 指定这个协议很重要
					data:JSON.stringify(data.field), //只有这一个参数，json格式，后台解析为实体，后台可以直接用
					success:function(data){
						if(data.status){
							layer.msg("创建成功",{time:2000,icon:6});
							setTimeout("location.href='school.html';",2000);
						}
						else{
								layer.msg("创建失败",{time:1000,icon:5});
						}
					}
				});
				return false;
            });
			form.val('contestInfo',{
				"competitionName":contest.competitionName,
				"acronym":contest.acronym,
				"startDate":contest.startDate,
				"submitDDL":contest.submitDDL,
				"checkDDL":contest.checkDDL,
				"reviewDDL":contest.reviewDDL,
				"endDate":contest.endDate,
				"description":contest.description,
			})
        });
		$("#return").click(function(){
			window.location.href='school.html';
		});
    </script>
</html>
